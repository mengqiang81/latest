# 个人保持最新技术栈的最佳实践类应用

## Features
* 分层架构
  * 依赖都指向那些我们不想经常更改的组件，多态（安全的函数指针）可以让源码依赖关系和系统控制流解耦
  * 在Java这类静态类型的编程语言中，在使用use、import、include这些语句时应该只引用那些包含接口、抽象类或者其他抽象类型声明的源文件，不应该引用任何具体实现。类似于C中的include xx.h 而非 xx.c
* 模块化单体
* Native Image
* 常用中间件最佳实践
* OpenTelemetry
* 事务管理
  * 对于业务可感知的单一一次操作，当为模块化单体架构时，使用进程内事务，当拆分为独立微服务时，使用XA事务（少数情况使用TCC模式）
  * 对于多步操作，如生成采购单后生成暂估应付，使用流程引擎编排和TCC模式（少数情况考虑Saga模式）
* 流程编排
  * 同步的用户体验，不代表同步的业务调用。比如采购审核通过生成暂估应付，未生成则审核无法通过。为了解耦采购和财务，采购域仍然是发出一个审核预通过状态，流程编排引擎可以编排审核通过和暂估应付的业务事务逻辑（TCC），审核通过和发货单生成的最终一致逻辑（最终一致性），但是在API交互上，可以同步等待暂估应付的流程完结再返回审核成功还是失败。
  * 流程编排的起点是command而非event
* 发布管理
  * Liquibase管理数据库变更
* 权限
  * API和功能点/权限点的关系（RBAC），RBAC 用@PreAuthorize 静态声明描述，元数据对应权限点@PreAuthorize("hasPermission('Order', 'DELETE')")
  * 数据权限（ABAC）

## Quick Start
* 执行 common下domain-fundation的publishToMavenLocal

## Q&A
* Q: 为什么只有interfaces为复数？
* A: interfaces 下的子模块是 **“不同类型的交互入口”**（API、消息、RPC 等），这些入口是 “平行且独立的集合”

* Q：实现了什么例子
* A：实现了一个交易域和库存域交互的例子，主要包括了拍占付减的逻辑